Û
lD:\_cloud\Dropbox\Projects\SpecDrill\SpecDrill\SpecDrill.Adapters.WebDriver\Extensions\IElementExtensions.cs
	namespace 	
	SpecDrill
 
. 
Adapters 
. 
	WebDriver &
.& '

Extensions' 1
{ 
public 

static 
class 
IElementExtensions *
{ 
public 
static 
IWebElement !
ToWebElement" .
(. /
this/ 3
IElement4 <
element= D
)D E
{ 	
using 
( 
element 
. 
Browser "
." #
ImplicitTimeout# 2
(2 3
TimeSpan3 ;
.; <
FromSeconds< G
(G H
$numH K
)K L
)L M
)M N
{ 
var 

webElement 
=  
element! (
.( )%
NativeElementSearchResult) B
.B C
NativeElementC P
asQ S
IWebElementT _
;_ `
if 
( 

webElement 
== !
null" &
)& '
{ 
throw 
new 
	Exception '
(' (
$"( * 
SpecDrill: Element (* >
{> ?
element? F
.F G
LocatorG N
}N O
) Not Found!O [
"[ \
)\ ]
;] ^
} 
return 

webElement !
;! "
} 
} 	
} 
} ı
sD:\_cloud\Dropbox\Projects\SpecDrill\SpecDrill\SpecDrill.Adapters.WebDriver\Extensions\IElementLocatorExtensions.cs
	namespace

 	
	SpecDrill


 
.

 
Adapters

 
.

 
	WebDriver

 &
.

& '

Extensions

' 1
{ 
public 

static 
class %
IElementLocatorExtensions 1
{ 
private 
static 
readonly 

Dictionary  *
<* +
By+ -
,- .
Func/ 3
<3 4
string4 :
,: ;
Selenium< D
.D E
ByE G
>G H
>H I

LocatorMapJ T
=U V
newW Z

Dictionary[ e
<e f
Byf h
,h i
Funcj n
<n o
stringo u
,u v
Seleniumw 
.	 Ä
By
Ä Ç
>
Ç É
>
É Ñ
(
Ñ Ö
)
Ö Ü
{Q R
{U V
ByW Y
.Y Z
IdZ \
,] ^
Selenium_ g
.g h
Byh j
.j k
Idk m
}m n
,n o
{U V
ByW Y
.Y Z
	ClassNameZ c
,c d
Seleniume m
.m n
Byn p
.p q
	ClassNameq z
}z {
,{ |
{U V
ByW Y
.Y Z
CssSelectorZ e
,f g
Seleniumh p
.p q
Byq s
.s t
CssSelectort 
}	 Ä
,
Ä Å
{U V
ByW Y
.Y Z
XPathZ _
,` a
Seleniumb j
.j k
Byk m
.m n
XPathn s
}s t
,t u
{U V
ByW Y
.Y Z
NameZ ^
,_ `
Seleniuma i
.i j
Byj l
.l m
Namem q
}q r
,r s
{U V
ByW Y
.Y Z
LinkTextZ b
,c d
Seleniume m
.m n
Byn p
.p q
LinkTextq y
}y z
,z {
{U V
ByW Y
.Y Z
PartialLinkTextZ i
,j k
Seleniuml t
.t u
Byu w
.w x
PartialLinkText	x á
}
á à
,
à â
{U V
ByW Y
.Y Z
TagNameZ a
,b c
Seleniumd l
.l m
Bym o
.o p
TagNamep w
}w x
,x y
}Q R
;R S
public 
static 
Selenium 
. 
By !

ToSelenium" ,
(, -
this- 1
IElementLocator2 A
locatorB I
)I J
{ 	
return 

LocatorMap 
[ 
locator %
.% &
LocatorType& 1
]1 2
(2 3
locator3 :
.: ;
LocatorValue; G
)G H
;H I
} 	
} 
} ë
fD:\_cloud\Dropbox\Projects\SpecDrill\SpecDrill\SpecDrill.Adapters.WebDriver\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 7
)7 8
]8 9
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 9
)9 :
]: ;
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *Ç
\D:\_cloud\Dropbox\Projects\SpecDrill\SpecDrill\SpecDrill.Adapters.WebDriver\SeleniumAlert.cs
	namespace

 	
	SpecDrill


 
.

 
Adapters

 
.

 
	WebDriver

 &
{ 
public 

class 
SeleniumAlert 
:  
IBrowserAlert! .
{ 
private 
Func 
< 
IAlert 
> 
alert "
;" #
public 
SeleniumAlert 
( 
Func !
<! "
IAlert" (
>( )
alert* /
)/ 0
{ 	
this 
. 
alert 
= 
alert 
; 
} 	
public 
string 
Text 
=> 
this "
." #
alert# (
(( )
)) *
.* +
Text+ /
;/ 0
public 
void 
Accept 
( 
) 
{ 	
this 
. 
alert 
( 
) 
. 
Accept 
(  
)  !
;! "
Wait 
. 
Until 
( 
( 
) 
=> 
alert "
(" #
)# $
==% '
null( ,
), -
;- .
} 	
public 
void 
Dismiss 
( 
) 
{ 	
this 
. 
alert 
( 
) 
. 
Dismiss  
(  !
)! "
;" #
Wait 
. 
Until 
( 
( 
) 
=> 
alert "
(" #
)# $
==% '
null( ,
), -
;- .
}   	
public"" 
void"" 
SendKeys"" 
("" 
string"" #
keys""$ (
)""( )
=>""* ,
alert""- 2
(""2 3
)""3 4
.""4 5
SendKeys""5 =
(""= >
keys""> B
)""B C
;""C D
}## 
}$$ Ñ≠
dD:\_cloud\Dropbox\Projects\SpecDrill\SpecDrill\SpecDrill.Adapters.WebDriver\SeleniumBrowserDriver.cs
	namespace 	
	SpecDrill
 
. 
Adapters 
. 
	WebDriver &
{ 
internal 
class !
SeleniumBrowserDriver (
:) *
IBrowserDriver+ 9
{ 
private 
static 
readonly 
string  &*
simulateHtml5DragAndDropScript' E
=F G
$str:H (
;::( )
private== 

IWebDriver== 
seleniumDriver== )
===* +
null==, 0
;==0 1
private?? 
ILogger?? 
Log?? 
=?? 
Infrastructure?? ,
.??, -
Logging??- 4
.??4 5
Log??5 8
.??8 9
Get??9 <
<??< =!
SeleniumBrowserDriver??= R
>??R S
(??S T
)??T U
;??U V
publicAA !
SeleniumBrowserDriverAA $
(AA$ %

IWebDriverAA% /
seleniumDriverAA0 >
)AA> ?
{BB 	
thisCC 
.CC 
seleniumDriverCC 
=CC  !
seleniumDriverCC" 0
;CC0 1
}DD 	
publicFF 
staticFF 
IBrowserDriverFF $
CreateFF% +
(FF+ ,

IWebDriverFF, 6
seleniumDriverFF7 E
)FFE F
{GG 	
returnHH 
newHH !
SeleniumBrowserDriverHH ,
(HH, -
seleniumDriverHH- ;
)HH; <
;HH< =
}II 	
publicKK 
voidKK 
GoToUrlKK 
(KK 
stringKK "
urlKK# &
)KK& '
{LL 	
seleniumDriverMM 
.MM 
NavigateMM #
(MM# $
)MM$ %
.MM% &
GoToUrlMM& -
(MM- .
urlMM. 1
)MM1 2
;MM2 3
}NN 	
publicPP 
voidPP 
ExitPP 
(PP 
)PP 
{QQ 	
seleniumDriverRR 
.RR 
QuitRR 
(RR  
)RR  !
;RR! "
}SS 	
publicUU 
stringUU 
TitleUU 
{VV 	
getWW 
{WW 
returnWW 
seleniumDriverWW '
.WW' (
TitleWW( -
;WW- .
}WW/ 0
setXX 
{XX 
}XX 
}ZZ 	
private\\ 
Func\\ 
<\\ 
IAlert\\ 
>\\ 
WdAlert\\ $
=>\\% '
(\\( )
)\\) *
=>\\+ -
{]] 	
try^^ 
{__ 
return`` 
this`` 
.`` 
seleniumDriver`` *
.``* +
SwitchTo``+ 3
(``3 4
)``4 5
.``5 6
Alert``6 ;
(``; <
)``< =
;``= >
}aa 
catchbb 
(bb #
NoAlertPresentExceptionbb *
)bb* +
{cc 
}cc 
returnee 
nullee 
;ee 
}ff 	
;ff	 

publichh 
IBrowserAlerthh 
Alerthh "
{ii 	
getjj 
{kk 
ifll 
(ll 
thisll 
.ll 
WdAlertll  
(ll  !
)ll! "
==ll# %
nullll& *
)ll* +
returnmm 
nullmm 
;mm  
returnoo 
newoo 
SeleniumAlertoo (
(oo( )
WdAlertoo) 0
)oo0 1
;oo1 2
}pp 
}qq 	
publicss 
boolss 
IsAlertPresentss "
=>ss# %
thisss& *
.ss* +
WdAlertss+ 2
!=ss3 5
nullss6 :
;ss: ;
publicuu 
voiduu &
ChangeBrowserDriverTimeoutuu .
(uu. /
TimeSpanuu/ 7
timeoutuu8 ?
)uu? @
{vv 	
thisww 
.ww 
seleniumDriverww 
.ww  
Manageww  &
(ww& '
)ww' (
.ww( )
Timeoutsww) 1
(ww1 2
)ww2 3
.ww3 4
ImplicitlyWaitww4 B
(wwB C
timeoutwwC J
)wwJ K
;wwK L
}xx 	
publiczz 
ReadOnlyCollectionzz !
<zz! "
objectzz" (
>zz( )
FindElementszz* 6
(zz6 7
IElementLocatorzz7 F
locatorzzG N
)zzN O
{{{ 	
var|| 
result|| 
=|| 
new|| 
List|| !
<||! "
object||" (
>||( )
(||) *
)||* +
;||+ ,
var}} 
elements}} 
=}} 
seleniumDriver}} )
.}}) *
FindElements}}* 6
(}}6 7
locator}}7 >
.}}> ?

ToSelenium}}? I
(}}I J
)}}J K
)}}K L
;}}L M
result~~ 
.~~ 
AddRange~~ 
(~~ 
elements~~ $
)~~$ %
;~~% &
return 
new 
ReadOnlyCollection )
<) *
object* 0
>0 1
(1 2
result2 8
)8 9
;9 :
}
ÄÄ 	
public
ää 
object
ää 
ExecuteJavaScript
ää '
(
ää' (
string
ää( .
js
ää/ 1
,
ää1 2
params
ää3 9
object
ää: @
[
ää@ A
]
ääA B
	arguments
ääC L
)
ääL M
{
ãã 	
var
åå  
javaScriptExecutor
åå "
=
åå# $
(
åå% &
seleniumDriver
åå& 4
as
åå5 7!
IJavaScriptExecutor
åå8 K
)
ååK L
;
ååL M
if
éé 
(
éé  
javaScriptExecutor
éé "
==
éé# %
null
éé& *
)
éé* +
{
èè 
return
ëë 
false
ëë 
;
ëë 
}
íí 
try
îî 
{
ïï 
return
ññ  
javaScriptExecutor
ññ )
.
ññ) *
ExecuteScript
ññ* 7
(
ññ7 8
js
ññ8 :
,
ññ: ;
	arguments
ññ< E
)
ññE F
;
ññF G
}
óó 
catch
òò 
(
òò 
	Exception
òò 
e
òò 
)
òò 
{
ôô 
Log
öö 
.
öö 
Error
öö 
(
öö 
e
öö 
,
öö 
$str
öö >
)
öö> ?
;
öö? @
return
õõ 
false
õõ 
;
õõ 
}
úú 
}
ùù 	
public
üü 
void
üü 
MoveToElement
üü !
(
üü! "
IElement
üü" *
element
üü+ 2
)
üü2 3
{
†† 	
var
°° 
actions
°° 
=
°° 
new
°° 
Actions
°° %
(
°°% &
this
°°& *
.
°°* +
seleniumDriver
°°+ 9
)
°°9 :
;
°°: ;
actions
¢¢ 
.
¢¢ 
MoveToElement
¢¢ !
(
¢¢! "
(
¢¢" #
element
¢¢# *
as
¢¢+ -
SeleniumElement
¢¢. =
)
¢¢= >
.
¢¢> ?
Element
¢¢? F
)
¢¢F G
;
¢¢G H
actions
££ 
.
££ 
Build
££ 
(
££ 
)
££ 
.
££ 
Perform
££ #
(
££# $
)
££$ %
;
££% &
}
§§ 	
public
¶¶ 
void
¶¶ 
Click
¶¶ 
(
¶¶ 
IElement
¶¶ "
element
¶¶# *
)
¶¶* +
{
ßß 	
(
®® 
element
®® 
as
®® 
SeleniumElement
®® '
)
®®' (
.
®®( )
Element
®®) 0
.
®®0 1
Click
®®1 6
(
®®6 7
)
®®7 8
;
®®8 9
}
©© 	
public
´´ 
void
´´ 
DoubleClick
´´ 
(
´´  
IElement
´´  (
element
´´) 0
)
´´0 1
{
¨¨ 	
var
≠≠ 
actions
≠≠ 
=
≠≠ 
new
≠≠ 
Actions
≠≠ %
(
≠≠% &
this
≠≠& *
.
≠≠* +
seleniumDriver
≠≠+ 9
)
≠≠9 :
;
≠≠: ;
actions
ÆÆ 
.
ÆÆ 
DoubleClick
ÆÆ 
(
ÆÆ  
element
ÆÆ  '
.
ÆÆ' (
ToWebElement
ÆÆ( 4
(
ÆÆ4 5
)
ÆÆ5 6
)
ÆÆ6 7
;
ÆÆ7 8
actions
ØØ 
.
ØØ 
Build
ØØ 
(
ØØ 
)
ØØ 
.
ØØ 
Perform
ØØ #
(
ØØ# $
)
ØØ$ %
;
ØØ% &
}
∞∞ 	
public
≤≤ 
void
≤≤ 
DragAndDrop
≤≤ 
(
≤≤  
IElement
≤≤  (
	draggable
≤≤) 2
,
≤≤2 3
int
≤≤4 7
offsetX
≤≤8 ?
,
≤≤? @
int
≤≤A D
offsetY
≤≤E L
)
≤≤L M
{
≥≥ 	
var
¥¥ 
fromElement
¥¥ 
=
¥¥ 
	draggable
¥¥ '
.
¥¥' (
ToWebElement
¥¥( 4
(
¥¥4 5
)
¥¥5 6
;
¥¥6 7
var
∂∂ 
builder
∂∂ 
=
∂∂ 
new
∂∂ 
Actions
∂∂ %
(
∂∂% &
this
∂∂& *
.
∂∂* +
seleniumDriver
∂∂+ 9
)
∂∂9 :
;
∂∂: ;
var
∑∑ 
size
∑∑ 
=
∑∑ 
fromElement
∑∑ "
.
∑∑" #
Size
∑∑# '
;
∑∑' (
builder
ππ 
.
ππ 
MoveToElement
ππ !
(
ππ! "
fromElement
ππ" -
)
ππ- .
;
ππ. /
builder
∫∫ 
.
∫∫ 
ClickAndHold
∫∫  
(
∫∫  !
fromElement
∫∫! ,
)
∫∫, -
;
∫∫- .
builder
ªª 
.
ªª 
MoveByOffset
ªª  
(
ªª  !
offsetX
ªª! (
,
ªª( )
offsetY
ªª* 1
)
ªª1 2
;
ªª2 3
builder
ºº 
.
ºº 
Release
ºº 
(
ºº 
)
ºº 
.
ºº 
Perform
ºº %
(
ºº% &
)
ºº& '
;
ºº' (
}
ΩΩ 	
public
øø 
void
øø 
DragAndDrop
øø 
(
øø  
IElement
øø  (
	draggable
øø) 2
,
øø2 3
IElement
øø4 <

dropTarget
øø= G
)
øøG H
{
¿¿ 	
var
¡¡ 
fromElement
¡¡ 
=
¡¡ 
	draggable
¡¡ '
.
¡¡' (
ToWebElement
¡¡( 4
(
¡¡4 5
)
¡¡5 6
;
¡¡6 7
var
¬¬ 
	toElement
¬¬ 
=
¬¬ 

dropTarget
¬¬ &
.
¬¬& '
ToWebElement
¬¬' 3
(
¬¬3 4
)
¬¬4 5
;
¬¬5 6
if
ƒƒ 
(
ƒƒ 
string
ƒƒ 
.
ƒƒ 
Compare
ƒƒ 
(
ƒƒ 
fromElement
ƒƒ *
.
ƒƒ* +
GetAttribute
ƒƒ+ 7
(
ƒƒ7 8
$str
ƒƒ8 C
)
ƒƒC D
??
ƒƒE G
string
ƒƒH N
.
ƒƒN O
Empty
ƒƒO T
,
ƒƒT U
$str
ƒƒV \
,
ƒƒ\ ]
true
ƒƒ^ b
)
ƒƒb c
==
ƒƒd f
$num
ƒƒg h
)
ƒƒh i
{
≈≈ 
ExecuteJavaScript
∆∆ !
(
∆∆! ",
simulateHtml5DragAndDropScript
∆∆" @
,
∆∆@ A
fromElement
∆∆B M
,
∆∆M N
	toElement
∆∆O X
)
∆∆X Y
;
∆∆Y Z
}
«« 
else
»» 
{
…… 
var
   
builder
   
=
   
new
   !
Actions
  " )
(
  ) *
this
  * .
.
  . /
seleniumDriver
  / =
)
  = >
;
  > ?
builder
ÀÀ 
.
ÀÀ 
MoveToElement
ÀÀ %
(
ÀÀ% &
fromElement
ÀÀ& 1
)
ÀÀ1 2
;
ÀÀ2 3
builder
ÃÃ 
.
ÃÃ 
ClickAndHold
ÃÃ $
(
ÃÃ$ %
fromElement
ÃÃ% 0
)
ÃÃ0 1
;
ÃÃ1 2
builder
ÕÕ 
.
ÕÕ 
MoveToElement
ÕÕ %
(
ÕÕ% &
	toElement
ÕÕ& /
)
ÕÕ/ 0
;
ÕÕ0 1
builder
ŒŒ 
.
ŒŒ 
Release
ŒŒ 
(
ŒŒ  
)
ŒŒ  !
.
ŒŒ! "
Perform
ŒŒ" )
(
ŒŒ) *
)
ŒŒ* +
;
ŒŒ+ ,
}
œœ 
}
–– 	
public
““ 
void
““ 
RefreshPage
““ 
(
““  
)
““  !
{
”” 	
seleniumDriver
‘‘ 
.
‘‘ 
Navigate
‘‘ #
(
‘‘# $
)
‘‘$ %
.
‘‘% &
Refresh
‘‘& -
(
‘‘- .
)
‘‘. /
;
‘‘/ 0
}
’’ 	
public
◊◊ 
void
◊◊ 
MaximizePage
◊◊  
(
◊◊  !
)
◊◊! "
{
ÿÿ 	
seleniumDriver
ŸŸ 
.
ŸŸ 
Manage
ŸŸ !
(
ŸŸ! "
)
ŸŸ" #
.
ŸŸ# $
Window
ŸŸ$ *
.
ŸŸ* +
Maximize
ŸŸ+ 3
(
ŸŸ3 4
)
ŸŸ4 5
;
ŸŸ5 6
}
⁄⁄ 	
public
‹‹ 
void
‹‹ 
SwitchToDocument
‹‹ $
(
‹‹$ %
)
‹‹% &
{
›› 	
seleniumDriver
ﬁﬁ 
.
ﬁﬁ 
SwitchTo
ﬁﬁ #
(
ﬁﬁ# $
)
ﬁﬁ$ %
.
ﬁﬁ% &
DefaultContent
ﬁﬁ& 4
(
ﬁﬁ4 5
)
ﬁﬁ5 6
;
ﬁﬁ6 7
}
ﬂﬂ 	
public
·· 
void
·· 
SwitchToFrame
·· !
(
··! "
IElement
··" *"
seleniumFrameElement
··+ ?
)
··? @
{
‚‚ 	
seleniumDriver
„„ 
.
„„ 
SwitchTo
„„ #
(
„„# $
)
„„$ %
.
„„% &
Frame
„„& +
(
„„+ ,
(
„„, -"
seleniumFrameElement
„„- A
as
„„B D
SeleniumElement
„„E T
)
„„T U
.
„„U V
Element
„„V ]
)
„„] ^
;
„„^ _
}
‰‰ 	
public
ÊÊ 
void
ÊÊ 
SetWindowSize
ÊÊ !
(
ÊÊ! "
int
ÊÊ" %
initialWidth
ÊÊ& 2
,
ÊÊ2 3
int
ÊÊ4 7
initialHeight
ÊÊ8 E
)
ÊÊE F
{
ÁÁ 	
seleniumDriver
ËË 
.
ËË 
Manage
ËË !
(
ËË! "
)
ËË" #
.
ËË# $
Window
ËË$ *
.
ËË* +
Size
ËË+ /
=
ËË0 1
new
ËË2 5
System
ËË6 <
.
ËË< =
Drawing
ËË= D
.
ËËD E
Size
ËËE I
(
ËËI J
initialWidth
ËËJ V
,
ËËV W
initialHeight
ËËX e
)
ËËe f
;
ËËf g
}
ÈÈ 	
void
ÎÎ 
IBrowserDriver
ÎÎ 
.
ÎÎ 
SwitchToWindow
ÎÎ *
<
ÎÎ* +
T
ÎÎ+ ,
>
ÎÎ, -
(
ÎÎ- .
IWindowElement
ÎÎ. <
<
ÎÎ< =
T
ÎÎ= >
>
ÎÎ> ?#
seleniumWindowElement
ÎÎ@ U
)
ÎÎU V
{
ÏÏ 	
var
ÌÌ 
windowCount
ÌÌ 
=
ÌÌ 
seleniumDriver
ÌÌ ,
.
ÌÌ, -
WindowHandles
ÌÌ- :
.
ÌÌ: ;
Count
ÌÌ; @
(
ÌÌ@ A
)
ÌÌA B
;
ÌÌB C
Wait
ÓÓ 
.
ÓÓ 
	WithRetry
ÓÓ 
(
ÓÓ 
)
ÓÓ 
.
ÓÓ 
Doing
ÓÓ "
(
ÓÓ" #
(
ÓÓ# $
)
ÓÓ$ %
=>
ÓÓ& (#
seleniumWindowElement
ÓÓ) >
.
ÓÓ> ?
Click
ÓÓ? D
(
ÓÓD E
)
ÓÓE F
)
ÓÓF G
.
ÓÓG H
Until
ÓÓH M
(
ÓÓM N
(
ÓÓN O
)
ÓÓO P
=>
ÓÓQ S
seleniumDriver
ÓÓT b
.
ÓÓb c
WindowHandles
ÓÓc p
.
ÓÓp q
Count
ÓÓq v
(
ÓÓv w
)
ÓÓw x
>
ÓÓy z
windowCountÓÓ{ Ü
)ÓÓÜ á
;ÓÓá à
var
 
mostRecentWindow
  
=
! "
seleniumDriver
# 1
.
1 2
WindowHandles
2 ?
.
? @
LastOrDefault
@ M
(
M N
)
N O
;
O P
if
ÒÒ 
(
ÒÒ 
mostRecentWindow
ÒÒ  
!=
ÒÒ! #
default
ÒÒ$ +
(
ÒÒ+ ,
string
ÒÒ, 2
)
ÒÒ2 3
)
ÒÒ3 4
{
ÚÚ 
seleniumDriver
ÛÛ 
.
ÛÛ 
SwitchTo
ÛÛ '
(
ÛÛ' (
)
ÛÛ( )
.
ÛÛ) *
Window
ÛÛ* 0
(
ÛÛ0 1
mostRecentWindow
ÛÛ1 A
)
ÛÛA B
;
ÛÛB C
}
ÙÙ 
}
ıı 	
public
˜˜ 
void
˜˜ 
CloseLastWindow
˜˜ #
(
˜˜# $
)
˜˜$ %
{
¯¯ 	
seleniumDriver
˘˘ 
.
˘˘ 
Close
˘˘  
(
˘˘  !
)
˘˘! "
;
˘˘" #
}
˙˙ 	
public
¸¸ 
string
¸¸ 

GetPdfText
¸¸  
(
¸¸  !
)
¸¸! "
{
˝˝ 	
StringBuilder
˛˛ 
pdfText
˛˛ !
=
˛˛" #
new
˛˛$ '
StringBuilder
˛˛( 5
(
˛˛5 6
)
˛˛6 7
;
˛˛7 8
string
ˇˇ 
	userAgent
ˇˇ 
=
ˇˇ 
(
ˇˇ  
string
ˇˇ  &
)
ˇˇ& '
ExecuteJavaScript
ˇˇ' 8
(
ˇˇ8 9
$str
ˇˇ9 U
)
ˇˇU V
??
ˇˇW Y
string
ˇˇZ `
.
ˇˇ` a
Empty
ˇˇa f
;
ˇˇf g
using
ÇÇ 
(
ÇÇ 
var
ÇÇ 
	webClient
ÇÇ  
=
ÇÇ! "
new
ÇÇ# &
	WebClient
ÇÇ' 0
(
ÇÇ0 1
)
ÇÇ1 2
)
ÇÇ2 3
{
ÉÉ 
var
ÑÑ $
formattedCookiesString
ÑÑ *
=
ÑÑ+ ,'
GetFormattedCookiesString
ÑÑ- F
(
ÑÑF G
)
ÑÑG H
;
ÑÑH I
Uri
ÜÜ 
uri
ÜÜ 
=
ÜÜ 
new
ÜÜ 
Uri
ÜÜ !
(
ÜÜ! "
seleniumDriver
ÜÜ" 0
.
ÜÜ0 1
Url
ÜÜ1 4
)
ÜÜ4 5
;
ÜÜ5 6
	webClient
áá 
.
áá 
Headers
áá !
.
áá! "
Add
áá" %
(
áá% &
HttpRequestHeader
áá& 7
.
áá7 8
Host
áá8 <
,
áá< =
uri
áá> A
.
ááA B
Host
ááB F
)
ááF G
;
ááG H
	webClient
àà 
.
àà 
Headers
àà !
.
àà! "
Add
àà" %
(
àà% &
HttpRequestHeader
àà& 7
.
àà7 8
	UserAgent
àà8 A
,
ààA B
	userAgent
ààC L
)
ààL M
;
ààM N
	webClient
ââ 
.
ââ 
Headers
ââ !
.
ââ! "
Add
ââ" %
(
ââ% &
HttpRequestHeader
ââ& 7
.
ââ7 8
Cookie
ââ8 >
,
ââ> ?$
formattedCookiesString
ââ@ V
)
ââV W
;
ââW X
	webClient
ää 
.
ää 
Headers
ää !
.
ää! "
Add
ää" %
(
ää% &
HttpRequestHeader
ää& 7
.
ää7 8
Accept
ää8 >
,
ää> ?
$str
ää@ Q
)
ääQ R
;
ääR S
using
åå 
(
åå 
var
åå 
	pdfStream
åå $
=
åå% &
new
åå' *
MemoryStream
åå+ 7
(
åå7 8
	webClient
åå8 A
.
ååA B
DownloadData
ååB N
(
ååN O
uri
ååO R
.
ååR S
OriginalString
ååS a
)
ååa b
)
ååb c
)
ååc d
using
çç 
(
çç 
var
çç 
	extractor
çç $
=
çç% &
new
çç' *

PdfExtract
çç+ 5
.
çç5 6
	Extractor
çç6 ?
(
çç? @
)
çç@ A
)
ççA B
return
éé 
	extractor
éé $
.
éé$ %
ExtractToString
éé% 4
(
éé4 5
	pdfStream
éé5 >
)
éé> ?
;
éé? @
}
èè 
}
êê 	
private
íí 
string
íí '
GetFormattedCookiesString
íí 0
(
íí0 1
)
íí1 2
{
ìì 	
StringBuilder
îî 

strCookies
îî $
=
îî% &
new
îî' *
StringBuilder
îî+ 8
(
îî8 9
)
îî9 :
;
îî: ;
foreach
ïï 
(
ïï 
var
ïï 
cookie
ïï 
in
ïï  "
(
ïï# $
seleniumDriver
ïï$ 2
.
ïï2 3
Manage
ïï3 9
(
ïï9 :
)
ïï: ;
.
ïï; <
Cookies
ïï< C
.
ïïC D

AllCookies
ïïD N
??
ïïO Q
new
ïïR U 
ReadOnlyCollection
ïïV h
<
ïïh i
OpenQA
ïïi o
.
ïïo p
Selenium
ïïp x
.
ïïx y
Cookie
ïïy 
>ïï Ä
(ïïÄ Å
newïïÅ Ñ
ListïïÖ â
<ïïâ ä
OpenQAïïä ê
.ïïê ë
Seleniumïïë ô
.ïïô ö
Cookieïïö †
>ïï† °
(ïï° ¢
)ïï¢ £
)ïï£ §
)ïï§ •
)ïï• ¶
{
ññ 

strCookies
óó 
.
óó 
Append
óó !
(
óó! "
$"
óó" $
{
óó$ %
cookie
óó% +
.
óó+ ,
Name
óó, 0
}
óó0 1
=
óó1 2
{
óó2 3
cookie
óó3 9
.
óó9 :
Value
óó: ?
}
óó? @
; 
óó@ B
"
óóB C
)
óóC D
;
óóD E
}
òò 
if
ôô 
(
ôô 

strCookies
ôô 
.
ôô 
Length
ôô !
>
ôô" #
$num
ôô$ %
)
ôô% &
{
ôô' (

strCookies
ôô) 3
.
ôô3 4
Remove
ôô4 :
(
ôô: ;

strCookies
ôô; E
.
ôôE F
Length
ôôF L
-
ôôM N
$num
ôôO P
,
ôôP Q
$num
ôôR S
)
ôôS T
;
ôôT U
}
ôôV W
return
õõ 

strCookies
õõ 
.
õõ 
ToString
õõ &
(
õõ& '
)
õõ' (
;
õõ( )
}
úú 	
}
ùù 
}ûû ˆE
eD:\_cloud\Dropbox\Projects\SpecDrill\SpecDrill\SpecDrill.Adapters.WebDriver\SeleniumBrowserFactory.cs
	namespace 	
	SpecDrill
 
. 
Adapters 
. 
	WebDriver &
{ 
public 

class "
SeleniumBrowserFactory '
:( )!
IBrowserDriverFactory* ?
{ 
private 
ILogger 
Log 
= 
Infrastructure ,
., -
Logging- 4
.4 5
Log5 8
.8 9
Get9 <
<< ="
SeleniumBrowserFactory= S
>S T
(T U
)U V
;V W
private 
readonly 

Dictionary #
<# $
BrowserNames$ 0
,0 1
Func2 6
<6 7
string7 =
,= >
IBrowserDriver? M
>M N
>N O
driverFactoryP ]
;] ^
private 
readonly 
Settings !
configuration" /
=0 1
null2 6
;6 7
public "
SeleniumBrowserFactory %
(% &
Settings& .
configuration/ <
)< =
{ 	
var 
aPath 
= 
System 
. 

Reflection )
.) *
Assembly* 2
.2 3 
GetExecutingAssembly3 G
(G H
)H I
.I J
LocationJ R
;R S
Log 
. 
Info 
( 
$" 
Assembly path =  '
{' (
aPath( -
}- .
". /
)/ 0
;0 1
this 
. 
configuration 
=  
configuration! .
;. /
driverFactory   
=   
new   

Dictionary    *
<  * +
BrowserNames  + 7
,  7 8
Func  9 =
<  = >
string  > D
,  D E
IBrowserDriver  F T
>  T U
>  U V
{!! 
{"" 
BrowserNames"" 
."" 
chrome"" %
,""% &
bdp""' *
=>""+ -
{$$ 
return'' !
SeleniumBrowserDriver'' 0
.''0 1
Create''1 7
(''7 8
new''8 ;
ChromeDriver''< H
(''H I
bdp''I L
)''_ `
)''` a
;''a b
}(( 
}(( 
,(( 
{)) 
BrowserNames)) 
.)) 
ie)) !
,))! "
bdp))# &
=>))' )!
SeleniumBrowserDriver))* ?
.))? @
Create))@ F
())F G
new))G J"
InternetExplorerDriver))K a
())a b
bdp))b e
)))e f
)))f g
}))h i
,))i j
{** 
BrowserNames** 
.** 
firefox** &
,**& '
bdp**( +
=>**, .
{++ 
Environment,, #
.,,# $"
SetEnvironmentVariable,,$ :
(,,: ;
$str,,; S
,,,S T
bdp,,U X
),,X Y
;,,Y Z
return-- !
SeleniumBrowserDriver-- 4
.--4 5
Create--5 ;
(--; <
new--< ?
FirefoxDriver--@ M
(--M N
)--N O
)--O P
;--P Q
}.. 
}.. 
,.. 
{// 
BrowserNames// 
.// 
opera// $
,//$ %
bdp//& )
=>//* ,!
SeleniumBrowserDriver//- B
.//B C
Create//C I
(//I J
new//J M
OperaDriver//N Y
(//Y Z
bdp//Z ]
)//] ^
)//^ _
}//` a
,//a b
{00 
BrowserNames00 
.00 
safari00 %
,00% &
bdp00' *
=>00+ -!
SeleniumBrowserDriver00. C
.00C D
Create00D J
(00J K
new00K N
SafariDriver00O [
(00[ \
bdp00\ _
)00_ `
)00` a
}00b c
}:: 
;:: 
};; 	
public== 
IBrowserDriver== 
Create== $
(==$ %
BrowserNames==% 1
browserName==2 =
)=== >
{>> 	
if?? 
(?? 
configuration?? 
.?? 
	WebDriver?? '
.??' (
IsRemote??( 0
)??0 1
{@@ 
LogAA 
.AA 
InfoAA 
(AA 
$"AA !
WebDriver.IsRemote = AA 0
{AA0 1
configurationAA1 >
.AA> ?
	WebDriverAA? H
.AAH I
IsRemoteAAI Q
}AAQ R
"AAR S
)AAS T
;AAT U
switchBB 
(BB 
browserNameBB #
)BB# $
{CC 
caseDD 
BrowserNamesDD %
.DD% &
chromeDD& ,
:DD, -
returnEE !
CreateRemoteWebDriverEE 4
(EE4 5
DesiredCapabilitiesEE5 H
.EEH I
ChromeEEI O
(EEO P
)EEP Q
)EEQ R
;EER S
caseFF 
BrowserNamesFF %
.FF% &
firefoxFF& -
:FF- .
returnGG !
CreateRemoteWebDriverGG 4
(GG4 5
DesiredCapabilitiesGG5 H
.GGH I
FirefoxGGI P
(GGP Q
)GGQ R
)GGR S
;GGS T
caseHH 
BrowserNamesHH %
.HH% &
operaHH& +
:HH+ ,
returnII !
CreateRemoteWebDriverII 4
(II4 5
DesiredCapabilitiesII5 H
.IIH I
OperaIII N
(IIN O
)IIO P
)IIP Q
;IIQ R
caseJJ 
BrowserNamesJJ %
.JJ% &
safariJJ& ,
:JJ, -
returnKK !
CreateRemoteWebDriverKK 4
(KK4 5
DesiredCapabilitiesKK5 H
.KKH I
SafariKKI O
(KKO P
)KKP Q
)KKQ R
;KKR S
caseLL 
BrowserNamesLL %
.LL% &
ieLL& (
:LL( )
returnMM !
CreateRemoteWebDriverMM 4
(MM4 5
DesiredCapabilitiesMM5 H
.MMH I
InternetExplorerMMI Y
(MMY Z
)MMZ [
)MM[ \
;MM\ ]
defaultNN 
:NN 
throwOO 
newOO !'
ArgumentOutOfRangeExceptionOO" =
(OO= >
$"OO> @,
 SpecDrill: Value Not Supported `OO@ `
{OO` a
browserNameOOa l
}OOl m
`!OOm o
"OOo p
)OOp q
;OOq r
}PP 
}QQ 
returnSS 
driverFactorySS  
[SS  !
browserNameSS! ,
]SS, -
(SS- .!
GetBrowserDriversPathSS. C
(SSC D
)SSD E
)SSE F
;SSF G
}TT 	
privateVV 
stringVV !
GetBrowserDriversPathVV ,
(VV, -
)VV- .
{WW 	
varXX 
browserDriversPathXX "
=XX# $
configurationXX% 2
.XX2 3
	WebDriverXX3 <
.XX< =
BrowserDriversPathXX= O
;XXO P
ifYY 
(YY 
!YY 
configurationYY 
.YY 
	WebDriverYY (
.YY( )
BrowserDriversPathYY) ;
.YY; <
ContainsYY< D
(YYD E
$strYYE J
)YYJ K
)YYK L
{ZZ 
var[[ 
currentPath[[ 
=[[  !
System[[" (
.[[( )
IO[[) +
.[[+ ,
Path[[, 0
.[[0 1
GetDirectoryName[[1 A
([[A B
System[[B H
.[[H I

Reflection[[I S
.[[S T
Assembly[[T \
.[[\ ] 
GetExecutingAssembly[[] q
([[q r
)[[r s
.[[s t
Location[[t |
)[[| }
;[[} ~
browserDriversPath\\ "
=\\# $
$"\\% '
{\\' (
currentPath\\( 3
}\\3 4
\\\\4 6
{\\6 7
browserDriversPath\\7 I
}\\I J
"\\J K
;\\K L
}]] 
return__ 
browserDriversPath__ %
;__% &
}`` 	
publicbb 
IBrowserDriverbb !
CreateRemoteWebDriverbb 3
(bb3 4
DesiredCapabilitiesbb4 G
desiredCapabilitiesbbH [
)bb[ \
{cc 	
returndd !
SeleniumBrowserDriverdd (
.dd( )
Createdd) /
(dd/ 0
newee 
RemoteWebDriveree  /
(ee/ 0
newff  #
Uriff$ '
(ff' (
configurationff( 5
.ff5 6
	WebDriverff6 ?
.ff? @
SeleniumServerUriff@ Q
)ffQ R
,ffR S
desiredCapabilitiesffT g
)ffg h
)ffh i
;ffi j
}gg 	
}hh 
}ii Ã$
oD:\_cloud\Dropbox\Projects\SpecDrill\SpecDrill\SpecDrill.Adapters.WebDriver\SeleniumElementLocatorExtensions.cs
	namespace		 	
	SpecDrill		
 
.		 
Adapters		 
.		 
	WebDriver		 &
{

 
public 

static 
class ,
 SeleniumElementLocatorExtensions 8
{ 
public 
static 
OpenQA 
. 
Selenium %
.% &
By& (
ToSeleniumLocator) :
(: ;
this; ?
IElementLocator@ O
seleniumLocatorP _
)_ `
{ 	
switch 
( 
seleniumLocator #
.# $
LocatorType$ /
)/ 0
{ 
case 
	SpecDrill 
. 
SecondaryPorts -
.- .
AutomationFramework. A
.A B
ByB D
.D E
	ClassNameE N
:N O
return 
OpenQA !
.! "
Selenium" *
.* +
By+ -
.- .
	ClassName. 7
(7 8
seleniumLocator8 G
.G H
LocatorValueH T
)T U
;U V
case 
	SpecDrill 
. 
SecondaryPorts -
.- .
AutomationFramework. A
.A B
ByB D
.D E
CssSelectorE P
:P Q
return 
OpenQA !
.! "
Selenium" *
.* +
By+ -
.- .
CssSelector. 9
(9 :
seleniumLocator: I
.I J
LocatorValueJ V
)V W
;W X
case 
	SpecDrill 
. 
SecondaryPorts -
.- .
AutomationFramework. A
.A B
ByB D
.D E
IdE G
:G H
return 
OpenQA !
.! "
Selenium" *
.* +
By+ -
.- .
Id. 0
(0 1
seleniumLocator1 @
.@ A
LocatorValueA M
)M N
;N O
case 
	SpecDrill 
. 
SecondaryPorts -
.- .
AutomationFramework. A
.A B
ByB D
.D E
LinkTextE M
:M N
return 
OpenQA !
.! "
Selenium" *
.* +
By+ -
.- .
LinkText. 6
(6 7
seleniumLocator7 F
.F G
LocatorValueG S
)S T
;T U
case 
	SpecDrill 
. 
SecondaryPorts -
.- .
AutomationFramework. A
.A B
ByB D
.D E
NameE I
:I J
return 
OpenQA !
.! "
Selenium" *
.* +
By+ -
.- .
Name. 2
(2 3
seleniumLocator3 B
.B C
LocatorValueC O
)O P
;P Q
case 
	SpecDrill 
. 
SecondaryPorts -
.- .
AutomationFramework. A
.A B
ByB D
.D E
PartialLinkTextE T
:T U
return 
OpenQA !
.! "
Selenium" *
.* +
By+ -
.- .
PartialLinkText. =
(= >
seleniumLocator> M
.M N
LocatorValueN Z
)Z [
;[ \
case 
	SpecDrill 
. 
SecondaryPorts -
.- .
AutomationFramework. A
.A B
ByB D
.D E
TagNameE L
:L M
return 
OpenQA !
.! "
Selenium" *
.* +
By+ -
.- .
TagName. 5
(5 6
seleniumLocator6 E
.E F
LocatorValueF R
)R S
;S T
case 
	SpecDrill 
. 
SecondaryPorts -
.- .
AutomationFramework. A
.A B
ByB D
.D E
XPathE J
:J K
return   
OpenQA   !
.  ! "
Selenium  " *
.  * +
By  + -
.  - .
XPath  . 3
(  3 4
seleniumLocator  4 C
.  C D
LocatorValue  D P
)  P Q
;  Q R
}!! 
return"" 
null"" 
;"" 
}## 	
}$$ 
}%% ˝
dD:\_cloud\Dropbox\Projects\SpecDrill\SpecDrill\SpecDrill.Adapters.WebDriver\SeleniumWindowElement.cs
	namespace		 	
	SpecDrill		
 
.		 
Adapters		 
.		 
	WebDriver		 &
{

 
public 

class !
SeleniumWindowElement &
<& '
T' (
>( )
:* +
SeleniumElement, ;
,; <
IWindowElement= K
<K L
TL M
>M N
where 
T 
: 
class 
, 
IPage 
{ 
public !
SeleniumWindowElement $
($ %
IBrowser% -
browser. 5
,5 6
IElement7 ?
parent@ F
,F G
IElementLocatorH W
locatorX _
)_ `
:a b
basec g
(g h
browserh o
,o p
parentq w
,w x
locator	y Ä
)
Ä Å
{ 	
this 
. 
browser 
= 
browser "
;" #
this 
. 
locator 
= 
locator "
;" #
} 	
public 
T 
Open 
( 
) 
{ 	
Wait 
. 

NoMoreThan 
( 
TimeSpan $
.$ %
FromSeconds% 0
(0 1
$num1 3
)3 4
)4 5
.5 6
Until6 ;
(; <
(< =
)= >
=>? A
thisB F
.F G
IsAvailableG R
)R S
;S T
Browser 
. 
SwitchToWindow "
(" #
this# '
)' (
;( )
IPage 

targetPage 
= 
browser &
.& '

CreatePage' 1
<1 2
T2 3
>3 4
(4 5
)5 6
;6 7

targetPage 
. 
ContextType "
=# $
PageContextTypes% 5
.5 6
Window6 <
;< =
Wait 
. 
Until 
( 
( 
) 
=> 

targetPage '
.' (
IsLoaded( 0
)0 1
;1 2

targetPage 
. 
WaitForSilence %
(% &
)& '
;' (
return 
( 
T 
) 

targetPage !
;! "
} 	
} 
} õ
cD:\_cloud\Dropbox\Projects\SpecDrill\SpecDrill\SpecDrill.Adapters.WebDriver\SeleniumFrameElement.cs
	namespace		 	
	SpecDrill		
 
.		 
Adapters		 
.		 
	WebDriver		 &
{

 
public 

class  
SeleniumFrameElement %
<% &
T& '
>' (
:) *
SeleniumElement+ :
,: ;
IFrameElement< I
<I J
TJ K
>K L
where 
T 
: 
class 
, 
IPage 
{ 
public  
SeleniumFrameElement #
(# $
IBrowser$ ,
browser- 4
,4 5
IElement6 >
parent? E
,E F
IElementLocatorG V
locatorW ^
)^ _
:` a
baseb f
(f g
browserg n
,n o
parentp v
,v w
locatorx 
)	 Ä
{ 	
this 
. 
browser 
= 
browser "
;" #
this 
. 
locator 
= 
locator "
;" #
} 	
public 
T 
SwitchTo 
( 
) 
=> 
Open #
(# $
)$ %
;% &
public 
T 
Open 
( 
) 
{ 	
Wait 
. 

NoMoreThan 
( 
TimeSpan $
.$ %
FromSeconds% 0
(0 1
$num1 3
)3 4
)4 5
.5 6
Until6 ;
(; <
(< =
)= >
=>? A
thisB F
.F G
IsAvailableG R
)R S
;S T
Browser 
. 
SwitchToFrame !
(! "
this" &
)& '
;' (
IPage 

targetPage 
= 
browser &
.& '

CreatePage' 1
<1 2
T2 3
>3 4
(4 5
)5 6
;6 7

targetPage 
. 
ContextType "
=# $
PageContextTypes% 5
.5 6
Frame6 ;
;; <
Wait 
. 
Until 
( 
( 
) 
=> 

targetPage '
.' (
IsLoaded( 0
)0 1
;1 2

targetPage 
. 
WaitForSilence %
(% &
)& '
;' (
return 
( 
T 
) 

targetPage !
;! "
} 	
} 
}   €
hD:\_cloud\Dropbox\Projects\SpecDrill\SpecDrill\SpecDrill.Adapters.WebDriver\SeleniumNavigationElement.cs
	namespace 	
	SpecDrill
 
. 
Adapters 
. 
	WebDriver &
{		 
public

 

class

 %
SeleniumNavigationElement

 *
<

* +
T

+ ,
>

, -
:

. /
SeleniumElement

0 ?
,

? @
INavigationElement

A S
<

S T
T

T U
>

U V
where 
T 
: 
class 
, 
IPage 
{ 
public %
SeleniumNavigationElement (
(( )
IBrowser) 1
browser2 9
,9 :
IElement; C
parentD J
,J K
IElementLocatorL [
locator\ c
)c d
:e f
baseg k
(k l
browserl s
,s t
parentu {
,{ |
locator	} Ñ
)
Ñ Ö
{ 	
this 
. 
browser 
= 
browser "
;" #
this 
. 
locator 
= 
locator "
;" #
} 	
private 
T 
Click 
( 
	ClickType !
	clickType" +
)+ ,
{ 	
void 
Click 
( 
) 
{ 
switch 
( 
	clickType !
)! "
{ 
case 
	ClickType "
." #
Double# )
:) *
this 
. 
browser $
.$ %
DoubleClick% 0
(0 1
this1 5
)5 6
;6 7
break8 =
;= >
case 
	ClickType "
." #
Single# )
:) *
default 
: 
this 
. 
Element $
.$ %
Click% *
(* +
)+ ,
;, -
break. 3
;3 4
} 
}   
Wait"" 
."" 
Until"" 
("" 
("" 
)"" 
=>"" 
this"" !
.""! "
IsAvailable""" -
)""- .
;"". /
IPage## 

targetPage## 
=## 
browser## &
.##& '

CreatePage##' 1
<##1 2
T##2 3
>##3 4
(##4 5
)##5 6
;##6 7
Wait$$ 
.$$ 
	WithRetry$$ 
($$ 
)$$ 
.$$ 
Doing$$ "
($$" #
($$# $
)$$$ %
=>$$& (
Click$$) .
($$. /
)$$/ 0
)$$0 1
.$$1 2
Until$$2 7
($$7 8
($$8 9
)$$9 :
=>$$; =

targetPage$$> H
.$$H I
IsLoaded$$I Q
)$$Q R
;$$R S

targetPage%% 
.%% 
WaitForSilence%% %
(%%% &
)%%& '
;%%' (
return&& 
(&& 
T&& 
)&& 

targetPage&&  
;&&  !
}'' 	
public(( 
T(( 
Click(( 
((( 
)(( 
=>(( 
this((  
.((  !
Click((! &
(((& '
	ClickType((' 0
.((0 1
Single((1 7
)((7 8
;((8 9
public** 
T** 
DoubleClick** 
(** 
)** 
=>** !
this**" &
.**& '
Click**' ,
(**, -
	ClickType**- 6
.**6 7
Double**7 =
)**= >
;**> ?
}++ 
},, º)
dD:\_cloud\Dropbox\Projects\SpecDrill\SpecDrill\SpecDrill.Adapters.WebDriver\SeleniumSelectElement.cs
	namespace		 	
	SpecDrill		
 
.		 
Adapters		 
.		 
	WebDriver		 &
{

 
public 

class !
SeleniumSelectElement &
:' (
SeleniumElement) 8
,8 9
ISelectElement: H
{ 
public !
SeleniumSelectElement $
($ %
IBrowser% -
browser. 5
,5 6
IElement7 ?
parent@ F
,F G
IElementLocatorH W
locatorX _
)_ `
:a b
basec g
(g h
browserh o
,o p
parentq w
,w x
locator	y Ä
)
Ä Å
{ 	
this 
. 
browser 
= 
browser "
;" #
this 
. 
locator 
= 
locator "
;" #
} 	
private 
SelectElement 
SelectElement +
{ 	
get 
{ 
var 
element 
= 
this "
." #
Element# *
as+ -
IWebElement. 9
;9 :
if 
( 
element 
== 
null #
)# $
throw 
new "
NullReferenceException 4
(4 5
$str5 R
)R S
;S T
return 
new 
SelectElement (
(( )
element) 0
)0 1
;1 2
} 
}   	
public"" 
ISelectElement"" 
SelectByText"" *
(""* +
string""+ 1

optionText""2 <
)""< =
{## 	
this$$ 
.$$ 
SelectElement$$ 
.$$ 
SelectByText$$ +
($$+ ,

optionText$$, 6
)$$6 7
;$$7 8
Log&& 
.&& 
Info&& 
(&& 
$str&& /
,&&/ 0

optionText&&1 ;
,&&; <
this&&= A
.&&A B
locator&&B I
)&&I J
;&&J K
return'' 
this'' 
;'' 
}(( 	
public** 
ISelectElement** 
SelectByValue** +
(**+ ,
string**, 2
optionValue**3 >
)**> ?
{++ 	
this,, 
.,, 
SelectElement,, 
.,, 
SelectByValue,, ,
(,,, -
optionValue,,- 8
),,8 9
;,,9 :
Log.. 
... 
Info.. 
(.. 
$str.. 0
,..0 1
optionValue..2 =
,..= >
this..? C
...C D
locator..D K
)..K L
;..L M
return// 
this// 
;// 
}00 	
public22 
ISelectElement22 
SelectByIndex22 +
(22+ ,
int22, /
optionIndex220 ;
)22; <
{33 	
this44 
.44 
SelectElement44 
.44 
SelectByIndex44 ,
(44, -
optionIndex44- 8
)448 9
;449 :
Log66 
.66 
Info66 
(66 
$str66 0
,660 1
optionIndex662 =
,66= >
this66? C
.66C D
locator66D K
)66K L
;66L M
return77 
this77 
;77 
}88 	
public:: 
string::  
GetOptionTextByIndex:: *
(::* +
int::+ .
optionIndex::/ :
)::: ;
{;; 	
return<< 
this<< 
.<< 
Element<< 
.<<  
FindElement<<  +
(<<+ ,
OpenQA<<, 2
.<<2 3
Selenium<<3 ;
.<<; <
By<<< >
.<<> ?
XPath<<? D
(<<D E
string<<E K
.<<K L
Format<<L R
(<<R S
$str<<S n
,<<n o
optionIndex<<p {
)<<{ |
)<<| }
)<<} ~
.<<~ 
Text	<< É
;
<<É Ñ
}== 	
public?? 
string?? 
SelectedOptionText?? (
{@@ 	
getAA 
{AA 
returnAA 
thisAA 
.AA 
SelectElementAA +
.AA+ ,
SelectedOptionAA, :
.AA: ;
TextAA; ?
;AA? @
}AAA B
}BB 	
publicDD 
stringDD 
SelectedOptionValueDD )
{EE 	
getFF 
{FF 
returnFF 
thisFF 
.FF 
SelectElementFF +
.FF+ ,
SelectedOptionFF, :
.FF: ;
GetAttributeFF; G
(FFG H
$strFFH O
)FFO P
;FFP Q
}FFR S
}GG 	
publicII 
intII 
OptionsCountII 
{JJ 	
getKK 
{KK 
returnKK 
thisKK 
.KK 
SelectElementKK +
.KK+ ,
OptionsKK, 3
.KK3 4
CountKK4 9
;KK9 :
}KK; <
}LL 	
}OO 
}PP ÊÆ
^D:\_cloud\Dropbox\Projects\SpecDrill\SpecDrill\SpecDrill.Adapters.WebDriver\SeleniumElement.cs
	namespace 	
	SpecDrill
 
. 
Adapters 
. 
	WebDriver &
{ 
internal 
enum 
	ClickType 
{ 
Single 
, 
Double 
} 
[ 
Flags 

]
 
public 

enum 
ElementStateFlags !
{ 
None 
= 
$num 
, 
	Displayed 
= 
$num 
, 
Enabled 
= 
$num 
} 
public 

class 
SeleniumElement  
:! "
IElement# +
{ 
	protected 
static 
ILogger  
Log! $
=% &
Infrastructure' 5
.5 6
Logging6 =
.= >
Log> A
.A B
GetB E
<E F
SeleniumElementF U
>U V
(V W
)W X
;X Y
	protected   
IBrowser   
browser   "
;  " #
	protected!! 
IElementLocator!! !
locator!!" )
;!!) *
	protected"" 
IElement"" 
parent"" !
;""! "
public$$ 
SeleniumElement$$ 
($$ 
IBrowser$$ '
browser$$( /
,$$/ 0
IElement$$1 9
parent$$: @
,$$@ A
IElementLocator$$B Q
locator$$R Y
)$$Y Z
{%% 	
this&& 
.&& 
browser&& 
=&& 
browser&& "
;&&" #
this'' 
.'' 
locator'' 
='' 
locator'' "
;''" #
this(( 
.(( 
parent(( 
=(( 
parent((  
;((  !
})) 	
public,, 
bool,, 

IsReadOnly,, 
{-- 	
get.. 
{.. 
return.. 
this.. 
... 
Element.. %
...% &
GetAttribute..& 2
(..2 3
$str..3 =
)..= >
!=..? A
null..B F
;..F G
}..H I
}// 	
public11 
bool11 
IsAvailable11 
=>11  "
AvailabilityTest11# 3
(113 4
this114 8
.118 9
ToWebElement119 E
(11E F
)11F G
)11G H
;11H I
private33 
bool33 
AvailabilityTest33 %
(33% &
IWebElement33& 1 
nativeLocatedElement332 F
)33F G
=>44 

Test44 
(44  
nativeLocatedElement44 $
,44$ %
$str44& 8
,448 9
(44: ;
state44; @
)44@ A
=>44B D
state44E J
.44J K
HasFlag44K R
(44R S
ElementStateFlags44S d
.44d e
	Displayed44e n
)44n o
&&44p r
state44s x
.44x y
HasFlag	44y Ä
(
44Ä Å
ElementStateFlags
44Å í
.
44í ì
Enabled
44ì ö
)
44ö õ
)
44õ ú
;
44ú ù
public66 
bool66 
IsDisplayed66 
=>66  "
Test66# '
(66' (
this66( ,
.66, -
ToWebElement66- 9
(669 :
)66: ;
,66; <
$str66= M
,66M N
(66O P
state66P U
)66U V
=>66W Y
state66Z _
.66_ `
HasFlag66` g
(66g h
ElementStateFlags66h y
.66y z
	Displayed	66z É
)
66É Ñ
)
66Ñ Ö
;
66Ö Ü
public77 
bool77 
	IsEnabled77 
=>77  
Test77! %
(77% &
this77& *
.77* +
ToWebElement77+ 7
(777 8
)778 9
,779 :
$str77; J
,77J K
(77L M
state77M R
)77R S
=>77T V
state77W \
.77\ ]
HasFlag77] d
(77d e
ElementStateFlags77e v
.77v w
Enabled77w ~
)77~ 
)	77 Ä
;
77Ä Å
private99 
Tuple99 
<99 
ElementStateFlags99 '
?99' (
,99( )
	Exception99* 3
>993 4 
InternalElementState995 I
{:: 	
get?? 
{@@ 
	ExceptionAA 
	exceptionAA #
=AA$ %
nullAA& *
;AA* +
SearchResultBB 
searchResultBB )
=BB* +
nullBB, 0
;BB0 1
tryCC 
{CC 
searchResultCC "
=CC# $
browserCC% ,
.CC, -
PeekElementCC- 8
(CC8 9
thisCC9 =
)CC= >
;CC> ?
}CC@ A
catchDD 
(DD 
NotFoundExceptionDD (
nfeDD) ,
)DD, -
{EE 
	exceptionFF 
=FF 
nfeFF  #
;FF# $
LogGG 
.GG 
ErrorGG 
(GG 
	exceptionGG '
,GG' (
$strGG) G
)GGG H
;GGH I
returnHH 
TupleHH  
.HH  !
CreateHH! '
(HH' (
(HH( )
ElementStateFlagsHH) :
?HH: ;
)HH; <
nullHH< @
,HH@ A
	exceptionHHB K
)HHK L
;HHL M
}II 
ifKK 
(KK 
!KK 
searchResultKK !
.KK! "
	HasResultKK" +
)KK+ ,
{LL 
varMM 
infoMM 
=MM 
$"MM !
	Element (MM! *
{MM* +
locatorMM+ 2
}MM2 3
) not found!MM3 ?
"MM? @
;MM@ A
LogNN 
.NN 
InfoNN 
(NN 
infoNN !
)NN! "
;NN" #
	exceptionOO 
=OO 
newOO  #
NotFoundExceptionOO$ 5
(OO5 6
infoOO6 :
)OO: ;
;OO; <
returnPP 
TuplePP  
.PP  !
CreatePP! '
(PP' (
(PP( )
ElementStateFlagsPP) :
?PP: ;
)PP; <
nullPP< @
,PP@ A
	exceptionPPB K
)PPK L
;PPL M
}QQ 
varSS 
locatedElementSS "
=SS# $
searchResultSS% 1
.SS1 2
NativeElementSS2 ?
asSS@ B
IWebElementSSC N
;SSN O
ifTT 
(TT 
locatedElementTT "
==TT# %
nullTT& *
)TT* +
{UU 
varVV 
infoVV 
=VV 
$"VV !
	Element (VV! *
{VV* +
searchResultVV, 8
.VV8 9
NativeElementVV9 F
?VVF G
.VVG H
GetTypeVVH O
(VVO P
)VVP Q
.VVQ R
ToStringVVR Z
(VVZ [
)VV[ \
??VV] _
$strVV` h
}VVi j%
) is not an IWebElement!	VVj Ç
"
VVÇ É
;
VVÉ Ñ
LogWW 
.WW 
InfoWW 
(WW 
infoWW !
)WW! "
;WW" #
returnXX 
TupleXX  
.XX  !
CreateXX! '
(XX' (
(XX( )
ElementStateFlagsXX) :
?XX: ;
)XX; <
ElementStateFlagsXX< M
.XXM N
NoneXXN R
,XXR S
newXXT W
	ExceptionXXX a
(XXa b
infoXXb f
,XXf g
	exceptionXXh q
)XXq r
)XXr s
;XXs t
}YY 
return[[ 
InternalStateTest[[ (
([[( )
locatedElement[[) 7
)[[7 8
;[[8 9
}\\ 
}]] 	
private__ 
bool__ 
Test__ 
(__ 
IWebElement__ % 
nativeLocatedElement__& :
,__: ;
string__< B
testName__C K
,__K L
Func__M Q
<__Q R
ElementStateFlags__R c
,__c d
bool__e i
>__i j
test__k o
)__o p
{`` 	
varaa 
resultaa 
=aa 
InternalStateTestaa *
(aa* + 
nativeLocatedElementaa+ ?
)aa? @
;aa@ A
ifcc 
(cc 
resultcc 
.cc 
Item2cc 
!=cc 
nullcc  $
)cc$ %
{dd 
Logee 
.ee 
Infoee 
(ee 
stringee 
.ee  
Formatee  &
(ee& '
$"ee' )
{ee) *
testNameee* 2
}ee2 3)
 test result: false ; Reason ee3 P
{eeP Q
(eeQ R
resulteeR X
.eeX Y
Item2eeY ^
?ee^ _
.ee_ `
ToStringee` h
(eeh i
)eei j
??eek m
$streen v
)eev w
}eew x
"eex y
)eey z
)eez {
;ee{ |
returnff 
falseff 
;ff 
}gg 
varii 

testResultii 
=ii 
resultii #
.ii# $
Item1ii$ )
.ii) *
HasValueii* 2
&&ii3 5
testii6 :
(ii: ;
resultii; A
.iiA B
Item1iiB G
.iiG H
ValueiiH M
)iiM N
;iiN O
ifkk 
(kk 
resultkk 
.kk 
Item1kk 
.kk 
HasValuekk %
&&kk& (
!kk) *

testResultkk* 4
)kk4 5
{ll 
varmm 
statemm 
=mm 
resultmm "
.mm" #
Item1mm# (
.mm( )
Valuemm) .
;mm. /
Lognn 
.nn 
Infonn 
(nn 
stringnn 
.nn  
Formatnn  &
(nn& '
$"nn' )
{nn) *
testNamenn* 2
}nn2 3'
 result: false > displayed:nn3 N
{nnN O
statennO T
.nnT U
HasFlagnnU \
(nn\ ]
ElementStateFlagsnn] n
.nnn o
	Displayednno x
)nnx y
}nny z

, enabled:	nnz Ñ
{
nnÑ Ö
state
nnÖ ä
.
nnä ã
HasFlag
nnã í
(
nní ì
ElementStateFlags
nnì §
.
nn§ •
Enabled
nn• ¨
)
nn¨ ≠
}
nn≠ Æ
"
nnÆ Ø
)
nnØ ∞
)
nn∞ ±
;
nn± ≤
}oo 
returnqq 

testResultqq 
;qq 
}rr 	
privatett 
Tuplett 
<tt 
ElementStateFlagstt '
?tt' (
,tt( )
	Exceptiontt* 3
>tt3 4
InternalStateTesttt5 F
(ttF G
IWebElementttG R 
nativeLocatedElementttS g
)ttg h
{uu 	
ElementStateFlagsvv 
statevv #
=vv$ %
ElementStateFlagsvv& 7
.vv7 8
Nonevv8 <
;vv< =
	Exceptionww 
	exceptionww 
=ww  !
nullww" &
;ww& '
tryxx 
{yy 
Logzz 
.zz 
Infozz 
(zz 
$"zz 
Testing State for zz -
{zz- .
$"zz/ 1
{zz1 2 
nativeLocatedElementzz2 F
.zzF G
TagNamezzG N
}zzN O
"zzO P
}zzP Q
 -> zzQ U
{zzU V
locatorzzV ]
}zz] ^
"zz^ _
)zz_ `
;zz` a
if{{ 
({{  
nativeLocatedElement{{ (
.{{( )
	Displayed{{) 2
){{2 3
state{{4 9
|={{: <
ElementStateFlags{{= N
.{{N O
	Displayed{{O X
;{{X Y
if|| 
(||  
nativeLocatedElement|| (
.||( )
Enabled||) 0
)||0 1
state||2 7
|=||8 :
ElementStateFlags||; L
.||L M
Enabled||M T
;||T U
return~~ 
Tuple~~ 
.~~ 
Create~~ #
(~~# $
(~~$ %
ElementStateFlags~~% 6
?~~6 7
)~~7 8
state~~8 =
,~~= >
	exception~~? H
)~~H I
;~~I J
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ ,
StaleElementReferenceException
ÅÅ 1
sere
ÅÅ2 6
)
ÅÅ6 7
{
ÇÇ 
	exception
ÉÉ 
=
ÉÉ 
sere
ÉÉ  
;
ÉÉ  !
Log
ÑÑ 
.
ÑÑ 
Error
ÑÑ 
(
ÑÑ 
	exception
ÑÑ #
,
ÑÑ# $
$str
ÑÑ% <
)
ÑÑ< =
;
ÑÑ= >
}
ÖÖ 
catch
ÜÜ 
(
ÜÜ 
NotFoundException
ÜÜ $
nfe
ÜÜ% (
)
ÜÜ( )
{
áá 
	exception
àà 
=
àà 
nfe
àà 
;
àà  
Log
ââ 
.
ââ 
Error
ââ 
(
ââ 
	exception
ââ #
,
ââ# $
$str
ââ% <
)
ââ< =
;
ââ= >
}
ää 
catch
ãã 
(
ãã 
	Exception
ãã 
e
ãã 
)
ãã 
{
åå 
	exception
çç 
=
çç 
e
çç 
;
çç 
Log
éé 
.
éé 
Error
éé 
(
éé 
	exception
éé #
,
éé# $
$str
éé% <
)
éé< =
;
éé= >
}
èè 
return
ëë 
Tuple
ëë 
.
ëë 
Create
ëë 
(
ëë  
(
ëë  !
ElementStateFlags
ëë! 2
?
ëë2 3
)
ëë3 4
state
ëë4 9
,
ëë9 :
	exception
ëë; D
)
ëëD E
;
ëëE F
}
íí 	
public
îî 
IBrowser
îî 
Browser
îî 
=>
îî  "
this
îî# '
.
îî' (
browser
îî( /
;
îî/ 0
private
ññ 
void
ññ 
Click
ññ 
(
ññ 
	ClickType
ññ $
	clickType
ññ% .
,
ññ. /
bool
ññ0 4
waitForSilence
ññ5 C
=
ññD E
false
ññF K
)
ññK L
{
óó 	
if
òò 
(
òò 
waitForSilence
òò 
)
òò 
{
òò  !
this
òò" &
.
òò& '
ContainingPage
òò' 5
.
òò5 6
WaitForSilence
òò6 D
(
òòD E
)
òòE F
;
òòF G
}
òòH I
Log
öö 
.
öö 
Info
öö 
(
öö 
$str
öö #
,
öö# $
this
öö% )
.
öö) *
locator
öö* 1
)
öö1 2
;
öö2 3
try
õõ 
{
úú 
if
ùù 
(
ùù 
	clickType
ùù 
==
ùù  
	ClickType
ùù! *
.
ùù* +
Single
ùù+ 1
)
ùù1 2
{
ûû 
this
üü 
.
üü 
Element
üü  
.
üü  !
Click
üü! &
(
üü& '
)
üü' (
;
üü( )
}
†† 
else
°° 
{
¢¢ 
this
££ 
.
££ 
browser
££  
.
££  !
DoubleClick
££! ,
(
££, -
this
££- 1
)
££1 2
;
££2 3
}
§§ 
}
•• 
catch
¶¶ 
(
¶¶ ,
StaleElementReferenceException
¶¶ 1
sere
¶¶2 6
)
¶¶6 7
{
ßß 
Log
®® 
.
®® 
Error
®® 
(
®® 
sere
®® 
,
®® 
$"
®®  "
Click: Element 
®®" 1
{
®®1 2
this
®®2 6
.
®®6 7
locator
®®7 >
}
®®> ?

 is stale!
®®? I
"
®®I J
)
®®J K
;
®®K L
throw
©© 
;
©© 
}
™™ 
catch
´´ 
(
´´ (
ElementNotVisibleException
´´ -
enve
´´. 2
)
´´2 3
{
¨¨ 
Log
≠≠ 
.
≠≠ 
Error
≠≠ 
(
≠≠ 
enve
≠≠ 
,
≠≠ 
$"
≠≠  "
Element 
≠≠" *
{
≠≠* +
this
≠≠+ /
.
≠≠/ 0
locator
≠≠0 7
}
≠≠7 8
 is not visible!
≠≠8 H
"
≠≠H I
)
≠≠I J
;
≠≠J K
throw
ÆÆ 
;
ÆÆ 
}
ØØ 
catch
∞∞ 
(
∞∞ '
InvalidOperationException
∞∞ ,
ioe
∞∞- 0
)
∞∞0 1
{
±± 
Log
≤≤ 
.
≤≤ 
Error
≤≤ 
(
≤≤ 
ioe
≤≤ 
,
≤≤ 
$"
≤≤ !
Clicking Element 
≤≤! 2
{
≤≤2 3
this
≤≤3 7
.
≤≤7 8
locator
≤≤8 ?
}
≤≤? @3
% caused an InvalidOperationException!
≤≤@ e
"
≤≤e f
)
≤≤f g
;
≤≤g h
}
≥≥ 
}
¥¥ 	
public
∂∂ 
void
∂∂ 
DoubleClick
∂∂ 
(
∂∂  
bool
∂∂  $
waitForSilence
∂∂% 3
=
∂∂4 5
false
∂∂6 ;
)
∂∂; <
=>
∂∂= ?
this
∂∂@ D
.
∂∂D E
Click
∂∂E J
(
∂∂J K
	ClickType
∂∂K T
.
∂∂T U
Double
∂∂U [
,
∂∂[ \
waitForSilence
∂∂] k
)
∂∂k l
;
∂∂l m
public
∏∏ 
void
∏∏ 
Click
∏∏ 
(
∏∏ 
bool
∏∏ 
waitForSilence
∏∏ -
=
∏∏. /
false
∏∏0 5
)
∏∏5 6
=>
∏∏7 9
this
∏∏: >
.
∏∏> ?
Click
∏∏? D
(
∏∏D E
	ClickType
∏∏E N
.
∏∏N O
Single
∏∏O U
,
∏∏U V
waitForSilence
∏∏W e
)
∏∏e f
;
∏∏f g
public
∫∫ 
IElement
∫∫ 
SendKeys
∫∫  
(
∫∫  !
string
∫∫! '
keys
∫∫( ,
,
∫∫, -
bool
∫∫. 2
waitForSilence
∫∫3 A
=
∫∫B C
false
∫∫D I
)
∫∫I J
{
ªª 	
if
ºº 
(
ºº 
waitForSilence
ºº 
)
ºº 
{
ºº  !
this
ºº" &
.
ºº& '
ContainingPage
ºº' 5
.
ºº5 6
WaitForSilence
ºº6 D
(
ººD E
)
ººE F
;
ººF G
}
ººH I
this
ΩΩ 
.
ΩΩ 
Element
ΩΩ 
.
ΩΩ 
SendKeys
ΩΩ !
(
ΩΩ! "
keys
ΩΩ" &
)
ΩΩ& '
;
ΩΩ' (
return
ææ 
this
ææ 
;
ææ 
}
øø 	
public
¡¡ 
void
¡¡ 
Blur
¡¡ 
(
¡¡ 
bool
¡¡ 
waitForSilence
¡¡ ,
=
¡¡- .
false
¡¡/ 4
)
¡¡4 5
{
¬¬ 	
if
√√ 
(
√√ 
waitForSilence
√√ 
)
√√ 
{
√√  !
this
√√" &
.
√√& '
ContainingPage
√√' 5
.
√√5 6
WaitForSilence
√√6 D
(
√√D E
)
√√E F
;
√√F G
}
√√H I
this
ƒƒ 
.
ƒƒ 
Element
ƒƒ 
.
ƒƒ 
SendKeys
ƒƒ !
(
ƒƒ! "
$str
ƒƒ" &
)
ƒƒ& '
;
ƒƒ' (
}
≈≈ 	
public
«« 
string
«« 
Text
«« 
{
»» 	
get
…… 
{
…… 
return
…… 
this
…… 
.
…… 
Element
…… %
.
……% &
Text
……& *
;
……* +
}
……, -
}
   	
public
ÃÃ 
string
ÃÃ 
GetCssValue
ÃÃ !
(
ÃÃ! "
string
ÃÃ" (
cssValueName
ÃÃ) 5
)
ÃÃ5 6
{
ÕÕ 	
try
ŒŒ 
{
œœ 
return
–– 
this
–– 
.
–– 
Element
–– #
.
––# $
GetCssValue
––$ /
(
––/ 0
cssValueName
––0 <
)
––< =
;
––= >
}
—— 
catch
““ 
(
““ ,
StaleElementReferenceException
““ 1
sere
““2 6
)
““6 7
{
”” 
Log
‘‘ 
.
‘‘ 
Error
‘‘ 
(
‘‘ 
sere
‘‘ 
,
‘‘ 
$"
‘‘  "#
GetCssValue: Element 
‘‘" 7
{
‘‘7 8
this
‘‘8 <
.
‘‘< =
locator
‘‘= D
}
‘‘D E

 is stale!
‘‘E O
"
‘‘O P
)
‘‘P Q
;
‘‘Q R
}
’’ 
return
◊◊ 
null
◊◊ 
;
◊◊ 
}
ÿÿ 	
public
⁄⁄ 
string
⁄⁄ 
GetAttribute
⁄⁄ "
(
⁄⁄" #
string
⁄⁄# )
attributeName
⁄⁄* 7
)
⁄⁄7 8
{
€€ 	
try
‹‹ 
{
›› 
return
ﬁﬁ 
this
ﬁﬁ 
.
ﬁﬁ 
Element
ﬁﬁ #
.
ﬁﬁ# $
GetAttribute
ﬁﬁ$ 0
(
ﬁﬁ0 1
attributeName
ﬁﬁ1 >
)
ﬁﬁ> ?
;
ﬁﬁ? @
}
ﬂﬂ 
catch
‡‡ 
(
‡‡ ,
StaleElementReferenceException
‡‡ 1
sere
‡‡2 6
)
‡‡6 7
{
·· 
Log
‚‚ 
.
‚‚ 
Error
‚‚ 
(
‚‚ 
sere
‚‚ 
,
‚‚ 
$"
‚‚  "$
GetAttribute: Element 
‚‚" 8
{
‚‚8 9
this
‚‚9 =
.
‚‚= >
locator
‚‚> E
}
‚‚E F

 is stale!
‚‚F P
"
‚‚P Q
)
‚‚Q R
;
‚‚R S
}
„„ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
e
‰‰ 
)
‰‰ 
{
ÂÂ 
string
ÊÊ 
z
ÊÊ 
=
ÊÊ 
e
ÊÊ 
.
ÊÊ 
Message
ÊÊ $
;
ÊÊ$ %
}
ÁÁ 
return
ÈÈ 
null
ÈÈ 
;
ÈÈ 
}
ÍÍ 	
public
ÏÏ 
void
ÏÏ 
Hover
ÏÏ 
(
ÏÏ 
bool
ÏÏ 
waitForSilence
ÏÏ -
=
ÏÏ. /
false
ÏÏ0 5
)
ÏÏ5 6
{
ÌÌ 	
if
ÓÓ 
(
ÓÓ 
waitForSilence
ÓÓ 
)
ÓÓ 
{
ÓÓ  !
this
ÓÓ" &
.
ÓÓ& '
ContainingPage
ÓÓ' 5
.
ÓÓ5 6
WaitForSilence
ÓÓ6 D
(
ÓÓD E
)
ÓÓE F
;
ÓÓF G
}
ÓÓH I
this
ÔÔ 
.
ÔÔ 
browser
ÔÔ 
.
ÔÔ 
Hover
ÔÔ 
(
ÔÔ 
this
ÔÔ #
)
ÔÔ# $
;
ÔÔ$ %
}
 	
public
ÚÚ 
IElement
ÚÚ 
Clear
ÚÚ 
(
ÚÚ 
bool
ÚÚ "
waitForSilence
ÚÚ# 1
=
ÚÚ2 3
false
ÚÚ4 9
)
ÚÚ9 :
{
ÛÛ 	
if
ÙÙ 
(
ÙÙ 
waitForSilence
ÙÙ 
)
ÙÙ 
{
ÙÙ  !
this
ÙÙ" &
.
ÙÙ& '
ContainingPage
ÙÙ' 5
.
ÙÙ5 6
WaitForSilence
ÙÙ6 D
(
ÙÙD E
)
ÙÙE F
;
ÙÙF G
}
ÙÙH I
this
ıı 
.
ıı 
Element
ıı 
.
ıı 
Clear
ıı 
(
ıı 
)
ıı  
;
ıı  !
return
ˆˆ 
this
ˆˆ 
;
ˆˆ 
}
˜˜ 	
public
˘˘ 
IElement
˘˘ "
SearchContainingPage
˘˘ ,
(
˘˘, -
IElement
˘˘- 5
element
˘˘6 =
)
˘˘= >
{
˙˙ 	
if
˚˚ 
(
˚˚ 
element
˚˚ 
is
˚˚ 
IPage
˚˚  
)
˚˚  !
return
¸¸ 
element
¸¸ 
;
¸¸ 
return
˛˛ 
(
˛˛ 
element
˛˛ 
.
˛˛ 
Parent
˛˛ "
!=
˛˛# %
null
˛˛& *
)
˛˛* +
?
˛˛, -"
SearchContainingPage
ˇˇ ,
(
ˇˇ, -
element
ˇˇ- 4
.
ˇˇ4 5
Parent
ˇˇ5 ;
)
ˇˇ; <
:
ˇˇ= >
null
ÄÄ 
;
ÄÄ 
}
ÅÅ 	
public
ÉÉ 
IPage
ÉÉ 
ContainingPage
ÉÉ #
=>
ÉÉ$ &"
SearchContainingPage
ÉÉ' ;
(
ÉÉ; <
this
ÉÉ< @
)
ÉÉ@ A
as
ÉÉB D
IPage
ÉÉE J
;
ÉÉJ K
public
ÖÖ 
SearchResult
ÖÖ '
NativeElementSearchResult
ÖÖ 5
{
ÜÜ 	
get
áá 
{
àà 
List
ââ 
<
ââ 
IElement
ââ 
>
ââ 
elementContainers
ââ 0
=
ââ1 2'
DiscoverElementContainers
ââ3 L
(
ââL M
)
ââM N
;
ââN O
if
ãã 
(
ãã 
elementContainers
ãã %
.
ãã% &
Count
ãã& +
==
ãã, .
$num
ãã/ 0
)
ãã0 1
return
åå 
this
åå 
.
åå  
browser
åå  '
.
åå' (
FindNativeElement
åå( 9
(
åå9 :
this
åå: >
.
åå> ?
Locator
åå? F
)
ååF G
;
ååG H
elementContainers
éé !
.
éé! "
Reverse
éé" )
(
éé) *
)
éé* +
;
éé+ ,
SearchResult
êê 
previousContainer
êê .
=
êê/ 0
this
êê1 5
.
êê5 6
browser
êê6 =
.
êê= >
FindNativeElement
êê> O
(
êêO P
elementContainers
êêP a
.
êêa b
First
êêb g
(
êêg h
)
êêh i
.
êêi j
Locator
êêj q
)
êêq r
;
êêr s
if
íí 
(
íí 
!
íí 
previousContainer
íí &
.
íí& '
	HasResult
íí' 0
)
íí0 1
return
ìì 
SearchResult
ìì '
.
ìì' (
Empty
ìì( -
;
ìì- .
bool
ïï 
isParentAvailable
ïï &
=
ïï' (
AvailabilityTest
ïï) 9
(
ïï9 :
previousContainer
ïï: K
.
ïïK L
NativeElement
ïïL Y
as
ïïZ \
IWebElement
ïï] h
)
ïïh i
;
ïïi j
Log
óó 
.
óó 
Info
óó 
(
óó 
$"
óó 
Finding element 
óó +
{
óó+ ,
locator
óó, 3
}
óó3 4
 which is nested 
óó4 E
{
óóE F
elementContainers
óóF W
.
óóW X
Count
óóX ]
}
óó] ^+
 level(s) deep. Its parent is
óó^ {
{
óó{ |
(
óó| } 
isParentAvailableóó} é
?óóè ê
stringóóë ó
.óóó ò
Emptyóóò ù
:óóû ü
$stróó† ¶
)óó¶ ß
}óóß ®
 available.óó® ≥
"óó≥ ¥
)óó¥ µ
;óóµ ∂
Log
òò 
.
òò 
Info
òò 
(
òò 
$"
òò 
L01>
òò 
{
òò  
elementContainers
òò  1
.
òò1 2
First
òò2 7
(
òò7 8
)
òò8 9
.
òò9 :
Locator
òò: A
}
òòA B
"
òòB C
)
òòC D
;
òòD E
if
öö 
(
öö 
elementContainers
öö %
.
öö% &
Count
öö& +
>
öö, -
$num
öö. /
)
öö/ 0
{
õõ 
for
úú 
(
úú 
int
úú 
i
úú 
=
úú  
$num
úú! "
;
úú" #
i
úú$ %
<
úú& '
elementContainers
úú( 9
.
úú9 :
Count
úú: ?
;
úú? @
i
úúA B
++
úúB D
)
úúD E
{
ùù 
var
ûû 
containerToSearch
ûû -
=
ûû. /
elementContainers
ûû0 A
[
ûûA B
i
ûûB C
]
ûûC D
;
ûûD E
previousContainer
üü )
=
üü* +.
 SearchElementInPreviousContainer
üü, L
(
üüL M
containerToSearch
üüM ^
,
üü^ _
previousContainer
üü` q
,
üüq r
i
üüs t
)
üüt u
;
üüu v
if
°° 
(
°° 
!
°° 
previousContainer
°° .
.
°°. /
	HasResult
°°/ 8
)
°°8 9
return
¢¢ "
SearchResult
¢¢# /
.
¢¢/ 0
Empty
¢¢0 5
;
¢¢5 6
}
££ 
}
§§ 
Log
¶¶ 
.
¶¶ 
Info
¶¶ 
(
¶¶ 
$"
¶¶ 
LOC>
¶¶ 
{
¶¶  
locator
¶¶  '
}
¶¶' (
"
¶¶( )
)
¶¶) *
;
¶¶* +
return
®® .
 SearchElementInPreviousContainer
®® 7
(
®®7 8
elementToSearch
©© #
:
©©# $
this
©©% )
,
©©) *
previousContainer
™™ %
:
™™% &
previousContainer
™™' 8
)
™™8 9
;
™™9 :
}
´´ 
}
¨¨ 	
private
ÆÆ 
List
ÆÆ 
<
ÆÆ 
IElement
ÆÆ 
>
ÆÆ '
DiscoverElementContainers
ÆÆ 8
(
ÆÆ8 9
)
ÆÆ9 :
{
ØØ 	
List
∞∞ 
<
∞∞ 
IElement
∞∞ 
>
∞∞ 
elementContainers
∞∞ ,
=
∞∞- .
new
∞∞/ 2
List
∞∞3 7
<
∞∞7 8
IElement
∞∞8 @
>
∞∞@ A
(
∞∞A B
)
∞∞B C
;
∞∞C D
IElement
≤≤ 
current
≤≤ 
=
≤≤ 
this
≤≤ #
.
≤≤# $
Parent
≤≤$ *
;
≤≤* +
if
¥¥ 
(
¥¥ 
current
¥¥ 
!=
¥¥ 
null
¥¥ 
)
¥¥  
{
µµ 
do
∂∂ 
{
∑∑ 
if
∏∏ 
(
∏∏ 
current
∏∏ 
is
∏∏  "
IControl
∏∏# +
||
∏∏, .
current
∏∏/ 6
is
∏∏7 9
IPage
∏∏: ?
)
∏∏? @
{
ππ 
elementContainers
∫∫ )
.
∫∫) *
Add
∫∫* -
(
∫∫- .
current
∫∫. 5
)
∫∫5 6
;
∫∫6 7
}
ªª 
current
ºº 
=
ºº 
current
ºº %
.
ºº% &
Parent
ºº& ,
;
ºº, -
}
ΩΩ 
while
ΩΩ 
(
ΩΩ 
current
ΩΩ  
!=
ΩΩ! #
null
ΩΩ$ (
)
ΩΩ( )
;
ΩΩ) *
}
ææ 
return
¿¿ 
elementContainers
¿¿ $
;
¿¿$ %
}
¡¡ 	
private
√√ 
SearchResult
√√ .
 SearchElementInPreviousContainer
√√ =
(
√√= >
IElement
√√> F
elementToSearch
√√G V
,
√√V W
SearchResult
√√X d
previousContainer
√√e v
,
√√v w
int
√√x {
i
√√| }
=
√√~ 
-√√Ä Å
$num√√Å Ç
)√√Ç É
{
ƒƒ 	
if
≈≈ 
(
≈≈ 
previousContainer
≈≈ !
==
≈≈" $
null
≈≈% )
||
≈≈* ,
!
≈≈- .
previousContainer
≈≈. ?
.
≈≈? @
	HasResult
≈≈@ I
)
≈≈I J
return
∆∆ 
SearchResult
∆∆ #
.
∆∆# $
Empty
∆∆$ )
;
∆∆) *
var
»» ,
previousContainerNativeElement
»» .
=
»»/ 0
previousContainer
»»1 B
.
»»B C
NativeElement
»»C P
as
»»Q S
IWebElement
»»T _
;
»»_ `
if
   
(
   
AvailabilityTest
    
(
    !,
previousContainerNativeElement
  ! ?
)
  ? @
)
  @ A
{
ÀÀ 
try
ÃÃ 
{
ÕÕ 
var
ŒŒ 
elements
ŒŒ  
=
ŒŒ! ",
previousContainerNativeElement
ŒŒ# A
.
ŒŒA B
FindElements
ŒŒB N
(
ŒŒN O
elementToSearch
ŒŒO ^
.
ŒŒ^ _
Locator
ŒŒ_ f
.
ŒŒf g
ToSeleniumLocator
ŒŒg x
(
ŒŒx y
)
ŒŒy z
)
ŒŒz {
;
ŒŒ{ |
if
œœ 
(
œœ 
(
œœ 
elementToSearch
œœ (
.
œœ( )
Locator
œœ) 0
.
œœ0 1
Index
œœ1 6
??
œœ7 9
$num
œœ: ;
)
œœ; <
>
œœ= >
elements
œœ? G
.
œœG H
Count
œœH M
)
œœM N
{
–– 
throw
—— 
new
—— !
	Exception
——" +
(
——+ ,
$"
——, .g
XSpecDrill: SeleniumElement.NativeElement : Not enough elements. You want element number ——. Ü
{——Ü á
locator——á é
.——é è
Index——è î
}——î ï

 but only ——ï ü
{——ü †
elements——† ®
.——® ©
Count——© Æ
}——Æ Ø
 were found.——Ø ª
"——ª º
)——º Ω
;——Ω æ
}
““ 
if
”” 
(
”” 
elements
””  
.
””  !
Count
””! &
==
””' )
$num
””* +
)
””+ ,
{
‘‘ 
return
’’ 
SearchResult
’’ +
.
’’+ ,
Empty
’’, 1
;
’’1 2
}
÷÷ 
previousContainer
◊◊ %
=
◊◊& '
SearchResult
◊◊( 4
.
◊◊4 5
Create
◊◊5 ;
(
◊◊; <
elements
◊◊< D
[
◊◊D E
(
◊◊E F
elementToSearch
◊◊F U
.
◊◊U V
Locator
◊◊V ]
.
◊◊] ^
Index
◊◊^ c
??
◊◊d f
$num
◊◊g h
)
◊◊h i
-
◊◊j k
$num
◊◊l m
]
◊◊m n
,
◊◊n o
elements
◊◊p x
.
◊◊x y
Count
◊◊y ~
)
◊◊~ 
;◊◊ Ä
}
ÿÿ 
catch
ŸŸ 
(
ŸŸ ,
StaleElementReferenceException
ŸŸ 5
sere
ŸŸ6 :
)
ŸŸ: ;
{
⁄⁄ 
Log
€€ 
.
€€ 
Error
€€ 
(
€€ 
sere
€€ "
,
€€" #
$"
€€$ &
L
€€& '
{
€€' (
i
€€( )
:
€€) *
00
€€* ,
}
€€, -
{
€€- .
elementToSearch
€€. =
.
€€= >
Locator
€€> E
}
€€E F
 - Is Stale !
€€F S
"
€€S T
)
€€T U
;
€€U V
return
‹‹ 
SearchResult
‹‹ '
.
‹‹' (
Empty
‹‹( -
;
‹‹- .
}
›› 
Log
ﬁﬁ 
.
ﬁﬁ 
Info
ﬁﬁ 
(
ﬁﬁ 
$"
ﬁﬁ 
L
ﬁﬁ 
{
ﬁﬁ 
i
ﬁﬁ 
:
ﬁﬁ 
00
ﬁﬁ !
}
ﬁﬁ! "
{
ﬁﬁ" #
elementToSearch
ﬁﬁ# 2
.
ﬁﬁ2 3
Locator
ﬁﬁ3 :
}
ﬁﬁ: ;
"
ﬁﬁ; <
)
ﬁﬁ< =
;
ﬁﬁ= >
}
ﬂﬂ 
else
‡‡ 
{
·· 
Log
‚‚ 
.
‚‚ 
Info
‚‚ 
(
‚‚ 
$"
‚‚ 9
+..some error.. Parent container was null...
‚‚ F
"
‚‚F G
)
‚‚G H
;
‚‚H I
}
‰‰ 
return
ÊÊ 
previousContainer
ÊÊ $
;
ÊÊ$ %
}
ÁÁ 	
public
ÈÈ 
void
ÈÈ 
DragAndDropTo
ÈÈ !
(
ÈÈ! "
IElement
ÈÈ" *
target
ÈÈ+ 1
)
ÈÈ1 2
{
ÍÍ 	
this
ÎÎ 
.
ÎÎ 
browser
ÎÎ 
.
ÎÎ 
DragAndDrop
ÎÎ $
(
ÎÎ$ %
this
ÎÎ% )
,
ÎÎ) *
target
ÎÎ+ 1
)
ÎÎ1 2
;
ÎÎ2 3
}
ÏÏ 	
public
ÓÓ 
void
ÓÓ 
DragAndDropAt
ÓÓ !
(
ÓÓ! "
int
ÓÓ" %
offsetX
ÓÓ& -
,
ÓÓ- .
int
ÓÓ/ 2
offsetY
ÓÓ3 :
)
ÓÓ: ;
{
ÔÔ 	
this
 
.
 
browser
 
.
 
DragAndDrop
 $
(
$ %
this
% )
,
) *
offsetX
+ 2
,
2 3
offsetY
4 ;
)
; <
;
< =
}
ÒÒ 	
internal
ÛÛ 
IWebElement
ÛÛ 
Element
ÛÛ $
{
ÙÙ 	
get
ıı 
{
ˆˆ 
Wait
˜˜ 
.
˜˜ 
Until
˜˜ 
(
˜˜ 
(
˜˜ 
)
˜˜ 
=>
˜˜  
this
˜˜! %
.
˜˜% &
IsAvailable
˜˜& 1
)
˜˜1 2
;
˜˜2 3
var
¯¯ 
nativeElement
¯¯ !
=
¯¯" #
this
¯¯$ (
.
¯¯( )'
NativeElementSearchResult
¯¯) B
.
¯¯B C
NativeElement
¯¯C P
as
¯¯Q S
IWebElement
¯¯T _
;
¯¯_ `
if
˘˘ 
(
˘˘ 
nativeElement
˘˘ !
==
˘˘" $
null
˘˘% )
)
˘˘) *
{
˙˙ 
throw
˚˚ 
new
˚˚ 
	Exception
˚˚ '
(
˚˚' (
$str
˚˚( G
)
˚˚G H
;
˚˚H I
}
¸¸ 
browser
˛˛ 
.
˛˛ 
ExecuteJavascript
˛˛ )
(
˛˛) *
$str
˛˛* X
,
˛˛X Y
nativeElement
˛˛Z g
)
˛˛g h
;
˛˛h i
return
ÄÄ 
nativeElement
ÄÄ $
;
ÄÄ$ %
}
ÅÅ 
}
ÇÇ 	
public
ÑÑ 
IElement
ÑÑ 
Parent
ÑÑ 
{
ÖÖ 	
get
ÜÜ 
{
áá 
return
àà 
this
àà 
.
àà 
parent
àà "
;
àà" #
}
ââ 
}
ää 	
public
åå 
IElementLocator
åå 
Locator
åå &
{
çç 	
get
éé 
{
èè 
return
êê 
this
êê 
.
êê 
locator
êê #
;
êê# $
}
ëë 
}
íí 	
public
îî 
int
îî 
Count
îî 
{
ïï 	
get
ññ 
{
óó 
Wait
òò 
.
òò 

NoMoreThan
òò 
(
òò  
TimeSpan
òò  (
.
òò( )
FromSeconds
òò) 4
(
òò4 5
$num
òò5 7
)
òò7 8
)
òò8 9
.
òò9 :
Until
òò: ?
(
òò? @
(
òò@ A
)
òòA B
=>
òòC E
this
òòF J
.
òòJ K
IsAvailable
òòK V
)
òòV W
;
òòW X
var
ôô 
nativeElement
ôô !
=
ôô" #
this
ôô$ (
.
ôô( )'
NativeElementSearchResult
ôô) B
.
ôôB C
NativeElement
ôôC P
;
ôôP Q
if
öö 
(
öö 
nativeElement
öö !
==
öö" $
null
öö% )
)
öö) *
return
õõ 
$num
õõ 
;
õõ 
browser
úú 
.
úú 
ExecuteJavascript
úú )
(
úú) *
$str
úú* Z
,
úúZ [
nativeElement
úú\ i
)
úúi j
;
úúj k
return
ùù 
this
ùù 
.
ùù '
NativeElementSearchResult
ùù 5
.
ùù5 6
Count
ùù6 ;
;
ùù; <
}
ûû 
}
üü 	
}
†† 
}°° Õ
eD:\_cloud\Dropbox\Projects\SpecDrill\SpecDrill\SpecDrill.Adapters.WebDriver\SeleniumElementLocator.cs
	namespace 	
	SpecDrill
 
. 
Adapters 
. 
	WebDriver &
{		 
public

 

class

 "
SeleniumElementLocator

 '
:

( )
IElementLocator

* 9
{ 
private 
readonly 
By 
locatorType '
;' (
private 
readonly 
string 
locatorValue  ,
;, -
private 
readonly 
int 
? 
index #
;# $
public "
SeleniumElementLocator %
(% &
By& (
locatorKind) 4
,4 5
string6 <
locatorValue= I
)I J
{ 	
this 
. 
locatorType 
= 
locatorKind *
;* +
this 
. 
locatorValue 
= 
locatorValue  ,
;, -
this 
. 
index 
= 
null 
; 
} 	
public "
SeleniumElementLocator %
(% &
By& (
locatorKind) 4
,4 5
string6 <
locatorValue= I
,I J
intK N
indexO T
)T U
:V W
thisX \
(\ ]
locatorKind] h
,h i
locatorValuej v
)v w
{ 	
this 
. 
index 
= 
index 
; 
} 	
public 
override 
string 
ToString '
(' (
)( )
{ 	
return 
string 
. 
Format  
(  !
$str! 3
,3 4
locatorType5 @
,@ A
locatorValueB N
)N O
;O P
} 	
public!! 
IElementLocator!! 
Copy!! #
(!!# $
)!!$ %
{"" 	
return## 
new## "
SeleniumElementLocator## -
(##- .
this##. 2
.##2 3
locatorType##3 >
,##> ?
this##@ D
.##D E
LocatorValue##E Q
)##Q R
;##R S
}$$ 	
public&& 
IElementLocator&& 
CopyWithIndex&& ,
(&&, -
int&&- 0
index&&1 6
)&&6 7
{'' 	
if(( 
((( 
index(( 
<(( 
$num(( 
)(( 
throw)) 
new)) $
IndexOutOfRangeException)) 2
())2 3
$str))3 {
))){ |
;))| }
return++ 
new++ "
SeleniumElementLocator++ -
(++- .
this++. 2
.++2 3
locatorType++3 >
,++> ?
this++@ D
.++D E
LocatorValue++E Q
,++Q R
index++S X
)++X Y
;++Y Z
},, 	
publicCC 
ByCC 
LocatorTypeCC 
{DD 	
getEE 
{EE 
returnEE 
locatorTypeEE $
;EE$ %
}EE& '
}FF 	
publicHH 
stringHH 
LocatorValueHH "
{II 	
getJJ 
{JJ 
returnJJ 
locatorValueJJ %
;JJ% &
}JJ' (
}KK 	
publicMM 
intMM 
?MM 
IndexMM 
{NN 	
getOO 
{PP 
returnQQ 
indexQQ 
;QQ 
}RR 
}SS 	
}TT 
}UU 